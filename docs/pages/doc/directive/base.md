---
title: Базовые директивы
sidebar: doc_sidebar
permalink: base_directives.html
folder: doc/directive
---

### name \<name\>
Переопределить [базовое имя приложения](#Базовое-имя-приложения) для собираемых docker image\`ей: \<базовое имя\>-dappstage:\<signature\>.

Опционально, по умолчанию определяется исходя из имени директории, в которой находится Dappfile.

### install\_depends\_on \<glob\>[,\<glob\>, \<glob\>, ...]
Список файлов зависимостей для стадии install.

* При изменении содержимого указанных файлов, произойдет пересборка стадии install.
* Учитывается лишь содержимое файлов и порядок в котором они указаны (имена файлов не учитываются).
* Поддерживаются glob-паттерны.
* Директории игнорируются.

### setup\_depends\_on \<glob\>[,\<glob\>, \<glob\>, ...]
Список файлов зависимостей для стадии setup.

* При изменении содержимого указанных файлов, произойдет пересборка стадии setup.
* Учитывается лишь содержимое файлов и порядок в котором они указаны (имена файлов не учитываются).
* Поддерживаются glob-паттерны.
* Директории игнорируются.

### builder \<builder\>
Тип сборки: **:chef** или **:shell**.
* Опционально, по умолчанию будет выбран тот сборщик, который будет использован первым (см. [Chef](#chef), [Shell](#shell)).
* При определении типа сборки, сборщик другого типа сбрасывается.
* При смене сборщика, необходимо явно изменять тип сборки.

#### Примеры

##### Собирать приложение X с **:chef** сборщиком, а Y c **:shell**

```ruby
app 'X' do
  chef.module 'a', 'b'
end
app 'Y' do
  shell.before_install 'apt-get install service'
end
```

##### Собирать приложения X-Y и Z с **:chef** сборщиком, а X-V c **:shell**
```ruby
chef.module 'a', 'b'

app 'X' do
  builder :shell

  app 'Y' do
    builder :chef
    chef.module 'c'
  end

  app 'V' do
    shell.install 'application install'
  end
end
app 'Z'
```

### tmp_dir \<dir\>\[, dir\]
Определяет [внешние директории сборки](#Внешняя-директория-сборки) для переданных путей **dir**, которые будут размещены во [временной директории приложения](#Временная-директория-приложения).

### build_dir \<dir\>\[, dir\]
Определяет [внешние директории сборки](#Внешняя-директория-сборки) для переданных путей **dir**, которые будут размещены в [директории сборки проекта](#Директория-сборки-проекта).

### app \<app\>\[, &blk\]
Определяет приложение <app> для сборки.

* Опционально, по умолчанию будет использоваться приложение с базовым именем (см. name \<name\>).
* Можно определять несколько приложений в одном Dappfile.
* При использовании блока создается новый контекст.
  * Наследуются все настройки родительского контекста.
  * Можно дополнять или переопределять настройки родительского контекста.
  * Можно использовать директиву app внутри нового контекста.
* При использовании вложенных вызовов директивы, будут использоваться только приложения указанные последними в иерархии. Другими словами, в описанном дереве приложений будут использованы только листья.
  * Правила именования вложенных приложений: \<app\>[-\<subapp\>-\<subsubapp\>...]

#### Примеры

##### Собирать приложения X и Y
```ruby
app 'X'
app 'Y'
```

##### Собирать приложения X, Y-Z и Y-K-M
```ruby
app 'X'
app 'Y' do
  app 'Z'

  app 'K' do
    app 'M'
  end
end
```

{% include links.html %}
